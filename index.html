<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø³Ø¨Ø­Ù‡ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© ğŸŒ™</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #0a0a0a;
            color: #e5e5e5;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            touch-action: manipulation;
        }

        .main-container {
            width: 100%;
            max-width: 380px;
            text-align: center;
            padding: 1.5rem;
        }

        /* Ø­Ù„Ù‚Ø© Ø§Ù„ØªØ³Ø¨ÙŠØ­ */
        .ring-container {
            position: relative;
            width: 250px;
            height: 250px;
            margin: 1.2rem auto;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tasbih-circle {
            width: 100%;
            height: 100%;
            border: 2px solid #333;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            background: radial-gradient(circle, #111 0%, #050505 100%);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .tasbih-circle:active {
            transform: scale(0.96);
            border-color: #d4af37;
        }

        .gold-glow {
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
            border-color: #d4af37 !important;
        }

        .control-btn {
            background: #1a1a1a;
            border: 1px solid #333;
            padding: 0.7rem;
            border-radius: 12px;
            font-size: 0.85rem;
            transition: 0.3s;
        }

        /* Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù„ÙˆÙŠØ© */
        .info-card {
            background: linear-gradient(145deg, #161616, #0d0d0d);
            border: 1px solid #d4af3722;
            border-radius: 15px;
            padding: 12px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

    <div class="main-container">
        <div class="grid grid-cols-2 gap-3 mb-4">
            <div class="info-card">
                <p class="text-[9px] text-[#d4af37] uppercase tracking-widest mb-1">Ø±Ù…Ø¶Ø§Ù† Ù…ØªØ¨Ù‚ÙŠ</p>
                <div class="text-lg font-bold"><span id="days-left">--</span> <span class="text-xs font-light text-gray-400">ÙŠÙˆÙ…</span></div>
            </div>
            <div class="info-card">
                <p class="text-[9px] text-[#d4af37] uppercase tracking-widest mb-1">Ø£Ø°Ø§Ù† Ø§Ù„Ù…ØºØ±Ø¨ (Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©)</p>
                <div id="maghrib-time" class="text-lg font-bold text-white">--:--</div>
            </div>
        </div>

        <div class="mb-4">
            <h1 class="text-[#d4af37] text-xs tracking-[0.2em] mb-1 uppercase font-light italic">Ø±Ù…Ø¶Ø§Ù† Ù…Ø¨Ø§Ø±Ùƒ</h1>
            <p id="dhikr-display" class="text-xl font-medium text-gray-200">Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡</p>
        </div>

        <div class="ring-container">
            <div id="main-tap" class="tasbih-circle">
                <span id="counter" class="text-7xl font-light tracking-tighter text-white">0</span>
                <span class="text-[10px] text-[#d4af37] mt-2 tracking-widest uppercase">Ø§Ø¶ØºØ· Ù„Ù„ØªØ³Ø¨ÙŠØ­</span>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-4 mb-6">
            <div class="bg-[#111] p-3 rounded-2xl border border-white/5">
                <span class="block text-[10px] text-gray-500 mb-1">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span>
                <span id="total-count" class="text-lg font-bold text-gray-300">0</span>
            </div>
            <div class="bg-[#111] p-3 rounded-2xl border border-white/5">
                <span class="block text-[10px] text-gray-500 mb-1">Ø§Ù„Ø¯ÙˆØ±Ø§Øª (33)</span>
                <span id="laps-count" class="text-lg font-bold text-gray-300">0</span>
            </div>
        </div>

        <div class="flex flex-col gap-2">
            <button onclick="changeDhikr()" class="control-btn text-gray-300 border-dashed border-gray-700">Ø§Ù„Ø°ÙƒØ± Ø§Ù„ØªØ§Ù„ÙŠ </button>
            <div class="grid grid-cols-2 gap-2">
                <button onclick="resetCounter()" class="control-btn text-red-400/80">ØªØµÙÙŠØ±</button>
                <button onclick="toggleSound()" id="sound-toggle" class="control-btn text-gray-300">ØµÙˆØª: ON</button>
            </div>
        </div>
    </div>

    <audio id="click-sfx" src="https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3"></audio>

    <script>
        let count = 0;
        let total = parseInt(localStorage.getItem('tasbih_total')) || 0;
        let isSoundOn = true;
        const dhikrs = ["Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡", "Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡", "Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡", "Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø±", "Ø£Ø³ØªØºÙØ± Ø§Ù„Ù„Ù‡", "Ø§Ù„Ù„Ù‡Ù… ØµÙ„Ù Ø¹Ù„Ù‰ Ù…Ø­Ù…Ø¯"];
        let dhikrIdx = 0;

        const mainBtn = document.getElementById('main-tap');
        const counterDisplay = document.getElementById('counter');
        const totalDisplay = document.getElementById('total-count');
        const lapsDisplay = document.getElementById('laps-count');
        const dhikrDisplay = document.getElementById('dhikr-display');
        const sfx = document.getElementById('click-sfx');

        // Ø¬Ù„Ø¨ Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù…ØºØ±Ø¨ Ù…Ù† API
        async function fetchMaghribTime() {
            try {
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© ÙƒÙ…Ø±Ø¬Ø¹ Ù„Ù…ØµØ±
                const response = await fetch('https://api.aladhan.com/v1/timingsByCity?city=Cairo&country=Egypt&method=5');
                const data = await response.json();
                const maghrib = data.data.timings.Maghrib;
                
                // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙˆÙ‚Øª Ù…Ù† Ù†Ø¸Ø§Ù… 24 Ø¥Ù„Ù‰ 12 Ø³Ø§Ø¹Ø©
                const [hours, minutes] = maghrib.split(':');
                const h = hours % 12 || 12;
                const ampm = hours >= 12 ? 'Ù…' : 'Øµ';
                
                document.getElementById('maghrib-time').innerText = `${h}:${minutes} ${ampm}`;
            } catch (error) {
                document.getElementById('maghrib-time').innerText = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„";
            }
        }

        function updateRamadanCountdown() {
            const now = new Date();
            // ØªØ§Ø±ÙŠØ® Ø±Ù…Ø¶Ø§Ù† 2026 Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠ (18 ÙØ¨Ø±Ø§ÙŠØ± 2026)
            let ramadanDate = new Date(2026, 1, 18); 
            
            const diffTime = ramadanDate - now;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            document.getElementById('days-left').innerText = diffDays > 0 ? diffDays : "Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ…";
        }

        // ØªÙ‡ÙŠØ¦Ø©
        totalDisplay.innerText = total;
        lapsDisplay.innerText = Math.floor(total / 33);
        updateRamadanCountdown();
        fetchMaghribTime();

        mainBtn.addEventListener('click', () => {
            count++;
            total++;
            counterDisplay.innerText = count;
            totalDisplay.innerText = total;
            lapsDisplay.innerText = Math.floor(total / 33);
            localStorage.setItem('tasbih_total', total);

            if ("vibrate" in navigator) navigator.vibrate(40);
            if (isSoundOn) { sfx.currentTime = 0; sfx.play(); }
            if (count % 33 === 0) {
                mainBtn.classList.add('gold-glow');
                setTimeout(() => mainBtn.classList.remove('gold-glow'), 300);
            }
        });

        function changeDhikr() {
            dhikrIdx = (dhikrIdx + 1) % dhikrs.length;
            dhikrDisplay.innerText = dhikrs[dhikrIdx];
            count = 0;
            counterDisplay.innerText = 0;
        }

        function resetCounter() {
            if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØµÙÙŠØ± Ø§Ù„Ø¹Ø¯Ø§Ø¯ØŸ")) {
                count = 0; total = 0;
                localStorage.setItem('tasbih_total', 0);
                counterDisplay.innerText = 0; totalDisplay.innerText = 0; lapsDisplay.innerText = 0;
            }
        }

        function toggleSound() {
            isSoundOn = !isSoundOn;
            document.getElementById('sound-toggle').innerText = isSoundOn ? "ØµÙˆØª: ON" : "ØµÙˆØª: OFF";
        }
    </script>
</body>
</html>
